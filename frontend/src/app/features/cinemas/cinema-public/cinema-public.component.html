<div class="wrap" *ngIf="cinemas().length; else noCinema">
  <!-- HERO -->
  <div class="hero">
    <div class="thumb">
      <img src="assets/posters/Cinemas_banner.jpg" alt="">
    </div>

    <div class="info">
      <h1>{{ selectedCinema()?.name || 'R·∫°p chi·∫øu' }}</h1>
      <div class="addr">üìç {{ selectedCinema()?.address || 'ƒêang c·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ' }}</div>
    </div>

    <div class="ctrl">
      <label>Ch·ªçn r·∫°p</label>
      <!-- IMPORTANT: ƒë·ªçc t·ª´ signal v√† set l·∫°i b·∫±ng ngModelChange -->
      <select [ngModel]="selectedCinemaId()" (ngModelChange)="onSelectCinema($event)">
        <option *ngFor="let c of cinemas()" [value]="c.id">{{ c.name }}</option>
      </select>
    </div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab" [class.active]="activeTab()==='now'"  (click)="activeTab.set('now')">PHIM ƒêANG CHI·∫æU</button>
    <button class="tab" [class.active]="activeTab()==='soon'" (click)="activeTab.set('soon')">PHIM S·∫ÆP CHI·∫æU</button>
  </div>

  <!-- NOW -->
  <section class="panel" *ngIf="activeTab()==='now'">
    <!-- ƒê√É B·ªé KH·ªêI 'Ng√†y' -->

    <div *ngIf="loading()" class="hint">ƒêang t·∫£i d·ªØ li·ªáu‚Ä¶</div>
    <div *ngIf="!loading() && groupsNow().length===0" class="hint">Ch∆∞a c√≥ phim ƒëang chi·∫øu.</div>

    <div class="grid" *ngIf="groupsNow().length">
      <article class="card" *ngFor="let g of groupsNow(); trackBy: trackByMovie">
        <div class="poster">
          <img [src]="posterOf(g)" [alt]="movieTitle(g)" (error)="imgFallback($event)" />
        </div>

        <div class="body">
          <h3 class="title">{{g.movie.title}}</h3>
          <div class="meta">
            <span *ngIf="g.movie.age_rating">ƒê·ªô tu·ªïi: {{g.movie.age_rating}}</span>
            <span *ngIf="g.movie.duration"> ‚Ä¢ {{g.movie.duration}}‚Ä≤</span>
          </div>

          <div class="times" *ngIf="g.showtimes?.length">
            <button class="chip" *ngFor="let st of g.showtimes; trackBy: trackBySt">
              {{ st.start_time | date:'HH:mm' }}
            </button>
          </div>

          <a class="link" [routerLink]="['/movies', g.movie.id]">Xem chi ti·∫øt</a>
        </div>
      </article>
    </div>
  </section>

  <!-- SOON -->
  <section class="panel" *ngIf="activeTab()==='soon'">
    <div *ngIf="loading()" class="hint">ƒêang t·∫£i d·ªØ li·ªáu‚Ä¶</div>
    <div *ngIf="!loading() && groupsSoon().length===0" class="hint">Ch∆∞a c√≥ phim s·∫Øp chi·∫øu.</div>

    <div class="grid" *ngIf="groupsSoon().length">
      <article class="card" *ngFor="let g of groupsSoon(); trackBy: trackByMovie">
        <div class="poster">
          <img [src]="posterOf(g)" [alt]="movieTitle(g)" (error)="imgFallback($event)" />
        </div>
        <div class="body">
          <h3 class="title">{{g.movie.title}}</h3>
          <div class="meta">
            <span *ngIf="g.movie.age_rating">ƒê·ªô tu·ªïi: {{g.movie.age_rating}}</span>
            <span *ngIf="g.movie.duration"> ‚Ä¢ {{g.movie.duration}}‚Ä≤</span>
          </div>

          <!-- C√≥ l·ªãch chi·∫øu th√¨ hi·ªán gi·ªù, ch∆∞a c√≥ th√¨ ghi ch√∫ -->
          <div class="times" *ngIf="g.showtimes?.length; else noTimeSoon">
            <button class="chip" *ngFor="let st of g.showtimes; trackBy: trackBySt">
              {{ st.start_time | date:'HH:mm' }}
            </button>
          </div>
          <ng-template #noTimeSoon>
            <div class="hint">Ch∆∞a c√≥ l·ªãch chi·∫øu</div>
          </ng-template>

          <a class="link" [routerLink]="['/movies', g.movie.id]">Xem chi ti·∫øt</a>
        </div>
      </article>
    </div>
  </section>


  <!-- PRICE -->
  <section class="panel" *ngIf="activeTab()==='price'">
    <div class="price">
      <div class="hint">B·∫£ng gi√° s·∫Ω l·∫•y t·ª´ BE (endpoint tu·ª≥ b·∫°n tri·ªÉn khai).</div>
    </div>
  </section>
</div>

<ng-template #noCinema>
  <div class="empty">
    Kh√¥ng t√¨m th·∫•y r·∫°p c√¥ng khai. H√£y ki·ªÉm tra API <code>/api/cinemas/public</code>.
  </div>
</ng-template>
